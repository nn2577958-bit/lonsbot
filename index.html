<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LONS Palworld ë¡œê·¸ì¸</title>
<link rel="icon" href="https://cdn.phototourl.com/uploads/2026-02-16-b555cb64-84f5-4ab4-b235-73d0d2be6482.png" type="image/png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
body { margin:0;height:100vh;display:flex;justify-content:center;align-items:center;font-family:'Segoe UI',Tahoma,Verdana,sans-serif;
background:linear-gradient(rgba(0,0,0,0.45),rgba(0,0,0,0.45)),url('https://cdn.phototourl.com/uploads/2026-02-16-be12475d-955e-4258-b559-d05dd22da876.jpg') center/cover no-repeat;}
.container {width:380px;background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(225,225,225,0.9));padding:35px 25px;border-radius:15px;box-shadow:0 8px 25px rgba(0,0,0,0.35);text-align:center;transition:transform 0.3s ease, box-shadow 0.3s ease;}
.container:hover {transform:translateY(-6px) scale(1.025);box-shadow:0 14px 38px rgba(0,0,0,0.4);}
h2 {color:#222;margin-bottom:20px;font-size:24px;}
button {width:100%;padding:14px;margin:10px 0;border-radius:8px;border:none;font-size:18px;font-weight:600;cursor:pointer;transition:all 0.23s ease;box-shadow:0px 4px 10px rgba(0,0,0,0.2);position:relative;}
button:hover {transform:translateY(-2px);box-shadow:0 6px 16px rgba(0,0,0,0.3);}
button:active {transform:translateY(1px);box-shadow:0 2px 6px rgba(0,0,0,0.2);}
button i {margin-right:8px;color:#DB4437;}
#google-btn {background:#fff;color:#444;border:1px solid #ccc;}
#google-btn:hover {background:#f0f0f0;}
#discord-btn {background:#7289DA;color:white;margin-top:10px;}
#discord-btn:hover {background:#5b6eae;}
#discord-btn.disabled {cursor:not-allowed;opacity:0.6;}
#discord-btn[data-tooltip]:hover::after {content:attr(data-tooltip);position:absolute;top:-30px;left:50%;transform:translateX(-50%);background:#444;color:#fff;padding:4px 8px;border-radius:6px;font-size:12px;white-space:nowrap;z-index:10;}
#admin-status {color:white;font-weight:bold;margin-bottom:10px;background:rgba(0,0,0,0.5);padding:6px 12px;border-radius:8px;display:inline-block;line-height:1.4;}
#login-msg {color:#ff4444;margin-bottom:10px;font-weight:500;text-align:center;}
</style>
</head>
<body>

<div class="container">
  <h2>LONS SV Palworld ë¡œê·¸ì¸</h2>
  <div id="admin-status">ê´€ë¦¬ì ìƒíƒœ í™•ì¸ì¤‘...</div>
  <div id="login-msg"></div>
  <button id="google-btn"><i class="fab fa-google"></i> Google ë¡œê·¸ì¸</button>
  <button id="discord-btn" class="disabled" data-tooltip="ë¡œê·¸ì¸ í›„ í™œì„±í™”ë©ë‹ˆë‹¤"><i class="fab fa-discord"></i> ë””ìŠ¤ì½”ë“œ ì°¸ì—¬í•˜ê¸°</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const adminStatus = document.getElementById("admin-status");
const googleBtn = document.getElementById("google-btn");
const discordBtn = document.getElementById("discord-btn");
const loginMsg = document.getElementById("login-msg");

let opacity = 1;
let fadingOut = true;

// ê´€ë¦¬ì ìƒíƒœ ê¹œë¹¡ì„
function updateAdminClock(isOnline){
  const now = new Date();
  const kstString = now.toLocaleString("ko-KR",{hour12:false,timeZone:"Asia/Seoul"});
  adminStatus.innerHTML = `${isOnline?"ğŸŸ¢ ê´€ë¦¬ì ì˜¨ë¼ì¸":"ğŸ”´ ê´€ë¦¬ì ì˜¤í”„ë¼ì¸"}<br>${kstString}`;

  if(fadingOut){ opacity -=0.05;if(opacity<=0){opacity=0;fadingOut=false;} }
  else{ opacity+=0.05;if(opacity>=1){opacity=1;fadingOut=true;} }
  adminStatus.style.opacity = opacity;
}

// ì´ˆê¸° ê¸°ë³¸ ì˜¨ë¼ì¸
setInterval(()=>updateAdminClock(true),1000);

onAuthStateChanged(auth, async (user)=>{
  let isAdmin = false;
  if(user){
    // ì„œë²„ë¡œ ID í† í° ë³´ë‚´ì„œ ê´€ë¦¬ì í™•ì¸
    const token = await user.getIdToken();
    const res = await fetch("/api/check-admin",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({idToken:token})
    });
    const data = await res.json();
    isAdmin = data.isAdmin;

    // ë””ìŠ¤ì½”ë“œ ë²„íŠ¼ í™œì„±í™”
    discordBtn.classList.remove('disabled');
    discordBtn.removeAttribute('data-tooltip');
  } else {
    discordBtn.classList.add('disabled');
    discordBtn.setAttribute('data-tooltip','ë¡œê·¸ì¸ í›„ í™œì„±í™”ë©ë‹ˆë‹¤');
  }
  updateAdminClock(isAdmin);
});

googleBtn.addEventListener("click", async ()=>{
  googleBtn.disabled=true;
  loginMsg.textContent="";
  const provider=new GoogleAuthProvider();
  try{
    await signInWithPopup(auth,provider);
    loginMsg.textContent="ë¡œê·¸ì¸ ì„±ê³µ! ë””ìŠ¤ì½”ë“œ ì°¸ì—¬í•˜ê¸° ë²„íŠ¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.";
  }catch(err){
    loginMsg.textContent="ë¡œê·¸ì¸ ì‹¤íŒ¨: "+err.message;
    googleBtn.disabled=false;
  }
});

discordBtn.addEventListener("click",()=>{
  if(discordBtn.classList.contains('disabled')){
    loginMsg.textContent="êµ¬ê¸€ ë¡œê·¸ì¸ í›„ ì°¸ì—¬í•˜ê¸° ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤!";
    return;
  }
  loginMsg.textContent="ì ì‹œ í›„ í™ˆìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤...";
  setTimeout(()=>window.location.href="home.html",1500);
});
</script>
</body>
</html>
